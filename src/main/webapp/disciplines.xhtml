<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
<h:head>
    <title>Дисциплины</title>
    <h:outputStylesheet library="css" name="styles.css"/>
    <h:outputScript library="js" name="websocket.js"/>
</h:head>
<h:body>
    <div class="container">
        <h1>Управление дисциплинами</h1>
        
        <!-- Навигационное меню -->
        <div class="menu">
            <h:form>
                <h:commandButton value="Главная" action="index" styleClass="menu-button"/>
                <h:commandButton value="Лабораторные работы" action="labworks" styleClass="menu-button"/>
                <h:commandButton value="Авторы" action="persons" styleClass="menu-button"/>
                <h:commandButton value="Дисциплины" action="disciplines" styleClass="menu-button"/>
                <h:commandButton value="Специальные операции" action="special-operations" styleClass="menu-button"/>
            </h:form>
        </div>
        
        <!-- Сообщения -->
        <h:panelGroup rendered="#{disciplineBean.message != null and disciplineBean.message != ''}">
            <div class="message message-#{disciplineBean.messageType}">
                #{disciplineBean.message}
            </div>
        </h:panelGroup>
        
        <!-- Фильтры -->
        <div class="filters">
            <h:form>
                <h3>Фильтры</h3>
                <div class="form-group">
                    <h:outputLabel for="nameFilter" value="Название:"/>
                    <h:inputText id="nameFilter" value="#{disciplineBean.nameFilter}" placeholder="Введите название"/>
                </div>
                
                <h:commandButton value="Применить фильтры" action="#{disciplineBean.applyFilters()}" 
                               styleClass="btn btn-primary"/>
                <h:commandButton value="Очистить" action="#{disciplineBean.clearFilters()}" 
                               styleClass="btn btn-secondary"/>
            </h:form>
        </div>
        
        <!-- Кнопки действий -->
        <div style="margin-bottom: 20px;">
            <h:form>
                <h:commandButton value="Создать новую дисциплину" action="create-discipline" 
                               styleClass="btn btn-success"/>
            </h:form>
        </div>
        
        <!-- Таблица дисциплин -->
        <h:dataTable value="#{disciplineBean.disciplines}" var="discipline" 
                    styleClass="data-table" rendered="#{not empty disciplineBean.disciplines}">
            <h:column>
                <f:facet name="header">ID</f:facet>
                #{discipline.id}
            </h:column>
            
            <h:column>
                <f:facet name="header">Название</f:facet>
                #{discipline.name}
            </h:column>
            
            <h:column>
                <f:facet name="header">Часы лекций</f:facet>
                #{discipline.lectureHours}
            </h:column>
            
            <h:column>
                <f:facet name="header">Часы практики</f:facet>
                #{discipline.practiceHours}
            </h:column>
            
            <h:column>
                <f:facet name="header">Часы самостоятельной работы</f:facet>
                #{discipline.selfStudyHours}
            </h:column>
            
            <h:column>
                <f:facet name="header">Действия</f:facet>
                <h:form>
                    <h:commandButton value="Просмотр" action="#{disciplineBean.viewDiscipline(discipline)}" 
                                   styleClass="btn btn-primary"/>
                    <h:commandButton value="Редактировать" action="#{disciplineBean.editDiscipline(discipline)}" 
                                   styleClass="btn btn-warning"/>
                    <h:commandButton value="Удалить" action="#{disciplineBean.deleteDiscipline(discipline)}" 
                                   styleClass="btn btn-danger" 
                                   onclick="return confirm('Вы уверены, что хотите удалить эту дисциплину?')"/>
                </h:form>
            </h:column>
        </h:dataTable>
        
        <!-- Сообщение о пустом списке -->
        <h:panelGroup rendered="#{empty disciplineBean.disciplines}">
            <div class="message message-info">
                Дисциплины не найдены. Попробуйте изменить фильтры или создать новую дисциплину.
            </div>
        </h:panelGroup>
        
        <!-- Пагинация -->
        <h:panelGroup rendered="#{disciplineBean.totalCount > 0}">
            <div class="pagination">
                <h:form>
                    <h:commandButton value="Первая" action="#{disciplineBean.firstPage()}" 
                                   styleClass="btn btn-secondary" 
                                   disabled="#{!disciplineBean.hasPreviousPage()}"/>
                    <h:commandButton value="Предыдущая" action="#{disciplineBean.previousPage()}" 
                                   styleClass="btn btn-secondary" 
                                   disabled="#{!disciplineBean.hasPreviousPage()}"/>
                    
                    <span class="pagination-info">
                        Страница #{disciplineBean.currentPageNumber} из #{disciplineBean.totalPages}
                        (Всего записей: #{disciplineBean.totalCount})
                    </span>
                    
                    <h:commandButton value="Следующая" action="#{disciplineBean.nextPage()}" 
                                   styleClass="btn btn-secondary" 
                                   disabled="#{!disciplineBean.hasNextPage()}"/>
                    <h:commandButton value="Последняя" action="#{disciplineBean.lastPage()}" 
                                   styleClass="btn btn-secondary" 
                                   disabled="#{!disciplineBean.hasNextPage()}"/>
                </h:form>
            </div>
        </h:panelGroup>
    </div>
</h:body>
</html>
